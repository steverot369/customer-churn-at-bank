
{% include 'managersidebar.html' %}

<section class="middle">
    <div class="header">
        
        <input type="date">
    </div>
                  <br>
                  <br>
        <!-- <div class="container1" style="margin-left:130px;"> -->

        <div class="container1">
                  
        <section >
            <h1>Credit Card requests</h1>
            <div class="search-filter">
                <input type="search" id="searchInput" class="search-input" onkeyup="searchTable()" placeholder="Search by name">
               
                
                <label for="rowCount">Select number of rows:</label>
                <select id="rowCount" onchange="changeRowCount()">
                  <option disabled selected value="">Select no of rows</option>
                    <option value="5">5</option>
                    <option value="10">10</option>
                    <option value="15">15</option>
                </select>
                
            </div>
          <form method="post" style="padding:20px;">  
            <table id="employeeTable" class="table">
                <thead class="thead-light">
                    <tr>
                       

                        
                        <th style="font-size: 16px;">Image</th>
                        <th style="font-size: 16px;">phone</th>
                        <th style="font-size: 16px;">Email</th>
                        <th style="font-size: 16px;">card Name</th> 
                        <th style="font-size: 16px;">card limit</th>
                      
                       
                        


                    </tr>
                </thead>
                <tbody>
                    <!-- Employee details data -->
                    {% for credit_card in credit_card_holders %}
                    <tr style="font-size: 15px;">  
                       
                        
                        

                        <td><img src="{{url_for('static', filename=credit_card[2])}}" style="width: 60px;height: 60px;border-radius: 50%;">{{ credit_card[0] }} {{ credit_card[1] }}</td>


                        <td>{{ credit_card[3] }}</td>
                        <td>{{ credit_card[4] }}</td>
                        <td>{{ credit_card[5] }}</td>
                        <td>{{ credit_card[6] }}</td>
                        
                          
                       
                        

                        <!-- 07-09-23 -->
                        
                        {% if credit_card[7] == 'approve' %}
                        <td style="color: green;">{{ credit_card[7] }}</td>
                        
                        {% endif %}
                        
                        
                
                    
                        <td>
                          <a href="#" class="btn btn-info view-details-btn" data-toggle="modal" data-target="#employeeDetailsModal" data-employee-details="{{ employee }}">View Details</a>
                        </td>
                       <!-- Add a container to display the file content -->
                       
                      </tr>
                     
                    
                    {% endfor %}
                    
                </tbody>
            </table>
          </form>
          <!-- Modal -->
<!-- Modal -->

            <div class="pagination">
                <button onclick="previousPage()">Previous</button>
                <button onclick="nextPage()">Next</button>
            </div>
            <div id="noUserFoundMessage" style="display: none;">
              <p>No user found</p>
            </div>
            
        </section>
    </div>
</section>
     </main> 
     <div id="file-popup-container" class="hidden">
        <div class="file-popup-content">
          <div id="file-container"></div>
          
          
      </div>
      <div class="zoom-buttons">
        <button id="zoom-in"><i class="fas fa-plus"></i>Zoom In</button>
        <button id="zoom-out"><i class="fas fa-minus"></i>Zoom Out</button>
        <button id="download-button"><i class="fas fa-download"></i></button>
      </div>
      <span id="close-icon">&times;</span>
      

    </div>
    <!-- ====================end of aside==========================   -->
    <!-- Modal -->
<!-- Modal -->
<div class="modal fade" id="employeeDetailsModal" tabindex="-1" role="dialog" aria-labelledby="employeeDetailsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="employeeDetailsModalLabel">Employee Details</h3>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <table>
          <tr>
            <td>Account number:</td>
            <td id="modalAccountNumber"></td>
          </tr>
          <tr>
            <td>Account holder name:</td>
            <td id="modalAccountHolderName"></td>
          </tr>
          <tr>
            <td>IFSC Code:</td>
            <td id="modalIFSCCode"></td>
          </tr>
          <tr>
            <td>Loan Type:</td>
            <td id="modalLoanType"></td>
          </tr>
          <tr>
            <td>Loan Amount:</td>
            <td id="modalLoanAmount"></td>
          </tr>
          <tr>
            <td>Interest(%):</td>
            <td style="color: rgb(230, 55, 55);" id="modalInterestAmount"></td>
          </tr>
          <tr>
            <td>Interest Rate:</td>
            <td id="modalInterestRate"></td>
          </tr>
          <tr>
            <td>Remaining Balance:</td>
            <td id="modalRemainingBalance"></td>
          </tr>
          <tr>
            <td>EMI due date:</td>
            <td id="modalEmiduedate"></td>
          </tr>
          <tr>
            <td>Status:</td>
            <td style="color: green;" id="modalStatus"></td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</div>



    
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
   
      
      <!-- <script>
        var viewButtons = document.querySelectorAll('.view-btn');
        var fileContainer = document.getElementById('file-container');
      
        viewButtons.forEach(function(button) {
          button.addEventListener('click', function() {
            var file = this.dataset.file;
      
            // Clear any previous content
            fileContainer.innerHTML = '';
      
            // Get the file extension
            var fileExtension = file.split('.').pop().toLowerCase();
      
            // Create appropriate element to display the file
            if (fileExtension === 'pdf') {
              var embed = document.createElement('embed');
              embed.src = file;
              embed.type = 'application/pdf';
              embed.width = '100%';
              embed.height = '1000px';
              fileContainer.appendChild(embed);
            } else if (fileExtension === 'doc' || fileExtension === 'docx') {
              var iframe = document.createElement('iframe');
              iframe.src = 'https://view.officeapps.live.com/op/embed.aspx?src=' + encodeURIComponent(file);
              iframe.width = '100%';
              iframe.height = '1000px';
              fileContainer.appendChild(iframe);
            } else if (fileExtension === 'jpg' || fileExtension === 'jpeg' || fileExtension === 'png') {
              var img = document.createElement('img');
              img.src = file;
              img.style.maxWidth = '100%';
              img.style.height = '100px';
              fileContainer.appendChild(img);
            } else {
              // Handle other file types or display an error message
              fileContainer.textContent = 'Unsupported file type.';
            }
          });
        });
      </script> -->
      
      <script>
        var viewButtons = document.querySelectorAll('.view-btn');
        var filePopupContainer = document.getElementById('file-popup-container');
        var fileContainer = document.getElementById('file-container');
        var closeIcon = document.getElementById('close-icon');
        var zoomInButton = document.getElementById('zoom-in');
        var zoomOutButton = document.getElementById('zoom-out');
        
        var currentZoom = 1;
        var downloadButton = document.getElementById('download-button');

        // Function to handle download button click
        downloadButton.addEventListener('click', function() {
        var fileUrl = fileContainer.querySelector('img, embed, iframe').src;
        var downloadLink = document.createElement('a');
        downloadLink.href = fileUrl;
        downloadLink.download = 'file';
        downloadLink.click();
        });


        
        viewButtons.forEach(function(button) {
          button.addEventListener('click', function() {
            var file = this.dataset.file;
        
            // Clear any previous content
            fileContainer.innerHTML = '';
        
            // Get the file extension
            var fileExtension = file.split('.').pop().toLowerCase();
        
            // Create appropriate element to display the file
            if (fileExtension === 'pdf') {
              var embed = document.createElement('embed');
              embed.src = file;
              embed.type = 'application/pdf';
              embed.width = '100%';
              embed.height = '1000px';
              fileContainer.appendChild(embed);
            } else if (fileExtension === 'doc' || fileExtension === 'docx') {
              var iframe = document.createElement('iframe');
              iframe.src = 'https://view.officeapps.live.com/op/embed.aspx?src=' + encodeURIComponent(file);
              iframe.width = '100%';
              iframe.height = '1000px';
              fileContainer.appendChild(iframe);
            } else if (fileExtension === 'jpg' || fileExtension === 'jpeg' || fileExtension === 'png') {
              var img = document.createElement('img');
              img.src = file;
              img.style.maxWidth = '100%';
              img.style.height = '100%';
              fileContainer.appendChild(img);
            } else {
              // Handle other file types or display an error message
              fileContainer.textContent = 'Unsupported file type.';
            }
        
            // Show the file popup container
            filePopupContainer.classList.remove('hidden');
          });
        });
        
        // Close the file popup container when the close icon is clicked
        closeIcon.addEventListener('click', function() {
          filePopupContainer.classList.add('hidden');
        });
        
        // Zoom in functionality
        zoomInButton.addEventListener('click', function() {
          currentZoom += 0.1;
          fileContainer.style.transform = 'scale(' + currentZoom + ')';
        });
        
        // Zoom out functionality
        zoomOutButton.addEventListener('click', function() {
          currentZoom -= 0.1;
          fileContainer.style.transform = 'scale(' + currentZoom + ')';
        });

        var zoomedIn = false;
var startX = 0;
var startY = 0;
var offsetX = 0;
var offsetY = 0;

// Zoom in functionality
zoomInButton.addEventListener('click', function() {
  if (!zoomedIn) {
    zoomedIn = true;
    fileContainer.style.cursor = 'grab';
    fileContainer.addEventListener('mousedown', startDragging);
    fileContainer.addEventListener('mousemove', dragImage);
    fileContainer.addEventListener('mouseup', stopDragging);
    fileContainer.addEventListener('mouseleave', stopDragging);
  }

  currentZoom += 0.1;
  fileContainer.style.transform = 'scale(' + currentZoom + ')';
});

// Zoom out functionality
zoomOutButton.addEventListener('click', function() {
  currentZoom -= 0.1;
  fileContainer.style.transform = 'scale(' + currentZoom + ')';
});

function startDragging(event) {
  startX = event.clientX;
  startY = event.clientY;
  offsetX = 0;
  offsetY = 0;
  fileContainer.style.cursor = 'grabbing';
}

function dragImage(event) {
  if (event.buttons !== 1) return; // Only drag when holding the left mouse button

  offsetX = event.clientX - startX;
  offsetY = event.clientY - startY;

  fileContainer.style.transform = 'scale(' + currentZoom + ') translate(' + offsetX + 'px, ' + offsetY + 'px)';
}

function stopDragging() {
  fileContainer.style.cursor = 'grab';
}

      </script>
      
      
       
        
      
      
    <script>
      $(document).ready(function() {
        $('.view-details-btn').click(function() {
          var employeeRow = $(this).closest('tr');
          var accountNumber = employeeRow.find('td:eq(1)').text();
          var accountHolderName = employeeRow.find('td:eq(0)').text();
          var ifscCode = employeeRow.find('td:eq(2)').text();
          var loanType = employeeRow.find('td:eq(3)').text();
          var loanAmount = employeeRow.find('td:eq(4)').text();
          var interestAmount = employeeRow.find('td:eq(5)').text();
          var interestRate = employeeRow.find('td:eq(6)').text();
          var remainingBalance = employeeRow.find('td:eq(7)').text();
          var emiduedate = employeeRow.find('td:eq(8)').text();
          var status = employeeRow.find('td:eq(9)').text();
    
          $('#modalAccountNumber').text(accountNumber);
          $('#modalAccountHolderName').text(accountHolderName);
          $('#modalIFSCCode').text(ifscCode);
          $('#modalLoanType').text(loanType);
          $('#modalLoanAmount').text(loanAmount);
          $('#modalInterestAmount').text(interestAmount);
          $('#modalInterestRate').text(interestRate);
          $('#modalRemainingBalance').text(remainingBalance);
          $('#modalEmiduedate').text(emiduedate);
          $('#modalStatus').text(status);
    
          $('#employeeDetailsModal').modal('show');
        });
      });
    </script>


    </script>
    <script>
        var submenuIcons = document.querySelectorAll('.submenu-icon');
      // Loop through each submenu icon
      submenuIcons.forEach(function(icon) {
         // Add a click event listener to each submenu icon
         icon.addEventListener('click', function() {
             // Get the corresponding submenu for this icon
             var submenu = icon.parentElement.nextElementSibling; 
             // Toggle the visibility of the submenu
             submenu.classList.toggle('show');
         });
      });
      </script>
    <script>
    
 // Get all the submenu icons
 var submenuIcons = document.querySelectorAll('.submenu-icon');
// Loop through each submenu icon
submenuIcons.forEach(function(icon) {
   // Add a click event listener to each submenu icon
   icon.addEventListener('click', function() {
       // Get the corresponding submenu for this icon
       var submenu = icon.parentElement.nextElementSibling; 
       // Toggle the visibility of the submenu
       submenu.classList.toggle('show');
   });
});


    function showDetails(event) {
    event.preventDefault();
    var row = event.target.closest("tr");
    var detailsRow = row.nextElementSibling;
    if (detailsRow.style.display === "none") {
      detailsRow.style.display = "table-row";
    } else {
      detailsRow.style.display = "none";
    }
  }

//ffffff





//efefff


//gender
var employeeTable = document.getElementById("employeeTable");
    var genderSelect = document.getElementById("genderOption");

    genderSelect.addEventListener("change", function() {
        var selectedGender = genderSelect.value.toLowerCase();
        var rows = employeeTable.getElementsByTagName("tr");

        for (var i = 1; i < rows.length; i++) { // Start from index 1 to skip the table header row
            var row = rows[i];
            var genderCell = row.getElementsByTagName("td")[5];
            var gender = genderCell.textContent.toLowerCase();

            if (selectedGender === "" || gender === selectedGender) {
                row.style.display = ""; // Show the row
            } else {
                row.style.display = "none"; // Hide the row
            }
        }
    });


// Add event listener to the "Employee Type" header
 // Function to sort the table based on gender

//end
        // Function to filter the table based on user type
        document.getElementById('userTypeFilter').addEventListener('change', function() {
  var searchKeyword = document.getElementById('searchInput').value.toLowerCase();
  var userType = this.value;
  var rows = document.querySelectorAll('#employeeTable tbody tr');
  
  rows.forEach(function(row) {
    var employeeName = row.children[1].textContent.toLowerCase() + ' ' + row.children[2].textContent.toLowerCase();
    var userRole = row.getAttribute('data-usertype');
    if ((searchKeyword === '' || employeeName.includes(searchKeyword)) && (userType === 'all' || userRole === userType)) {
      row.style.display = '';
    } else {
      row.style.display = 'none';
    }
  });
});

        // Function to search the table based on name
        function searchTable() {
  var input = document.getElementById("searchInput");
  var filter = input.value.toUpperCase();
  var table = document.getElementById("employeeTable");
  var rows = table.getElementsByTagName("tr");
  var noUserFoundMessage = document.getElementById("noUserFoundMessage");

  var foundMatch = false;

  for (var i = 1; i < rows.length; i++) {
    var nameColumn = rows[i].getElementsByTagName("td")[0];
    if (nameColumn.innerHTML.toUpperCase().indexOf(filter) > -1) {
      rows[i].style.display = "";
      foundMatch = true;
    } else {
      rows[i].style.display = "none";
    }
  }

  if (!foundMatch) {
    noUserFoundMessage.style.display = "block";
  } else {
    noUserFoundMessage.style.display = "none";
  }
}







        // ------------------------
        function changeRowCount() {
    const rowCountSelect = document.getElementById('rowCount');
    const selectedRowCount = rowCountSelect.value;
    const rows = employeeTable.getElementsByTagName('tr');

    for (let i = 1; i < rows.length; i++) {
        if (i <= selectedRowCount) {
            rows[i].style.display = '';
        } else {
            rows[i].style.display = 'none';
        }
    }
}
document.addEventListener('DOMContentLoaded', () => {
    const rowCountSelect = document.getElementById('rowCount');
    const selectedRowCount = rowCountSelect.value;
    const rows = employeeTable.getElementsByTagName('tr');

    for (let i = 1; i < rows.length; i++) {
        if (i > selectedRowCount) {
            rows[i].style.display = 'none';
        }
    }
});
const rowsPerPage = 5; // Number of rows to display per page
let currentPage = 1;

function showRows() {
    const startIndex = (currentPage - 1) * rowsPerPage;
    const endIndex = startIndex + rowsPerPage;
    const rows = employeeTable.getElementsByTagName('tr');

    for (let i = 1; i < rows.length; i++) {
        if (i >= startIndex && i < endIndex) {
            rows[i].style.display = '';
        } else {
            rows[i].style.display = 'none';
        }
    }
}

function previousPage() {
    if (currentPage > 1) {
        currentPage--;
        showRows();
    }
}

function nextPage() {
    const rows = employeeTable.getElementsByTagName('tr');
    const totalRows = rows.length - 1;
    const totalPages = Math.ceil(totalRows / rowsPerPage);

    if (currentPage < totalPages) {
        currentPage++;
        showRows();
    }
}

// Add this code after the existing JavaScript code within the <script> tags
document.addEventListener('DOMContentLoaded', () => {
    showRows();
});

    </script>
</body>
</html>